<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Description</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=El+Messiri:wght@700&display=swap');
        :root {
            --family: 'Nunito', sans-serif;
        }

        * {
            -webkit-transition: all .3s ease-out;
            -moz-transition: all .3s ease-out;
            -ms-transition: all .3s ease-out;
            -o-transition: all .3s ease-out;
            transition: all .3s ease-out;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-size: 17px;
            color: #666;
            text-align: center;
            font-family: var(--family);
            background: rgb(0, 159, 231);
            background: linear-gradient(326deg, rgba(147, 13, 224, 1) 0%, rgba(0, 159, 231, 1) 15%, rgb(101, 146, 146) 50%, rgb(169, 116, 192) 100%);
            background-repeat: no-repeat;
            background-size: 100% 700%;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

         .top {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          z-index: 1000; 
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
          background: linear-gradient(to right, rgb(97, 177, 217), #fff 35%, #a73de9);
          border-radius: 15px;
          padding: 10px 50px;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      
      .top ul {
          display: flex;
          align-items: center;
          list-style: none;
          margin: 0;
          padding: 0;
      }
      
      .top li {
          margin: 0 15px;
      }
      
      .top a {
          text-decoration: none;
          color: rgb(0, 0, 0);
          font-size: 20px;
      }
      
      .logo {
          width: 100px;
          height: auto;
          cursor: pointer;
      } */
      
      @media (max-width: 768px) {
          .top {
              padding: 10px; /* Adjust padding for smaller screens */
          }
          .top li {
              margin: 0 10px; /* Adjust margin for smaller screens */
          }
      }


      .form select {
        width: 100%;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
        background-color: #f7f7f7;
        appearance: none; /* Removes default arrow on some browsers */
        -webkit-appearance: none; /* For older versions of Chrome */
        -moz-appearance: none; /* For older versions of Firefox */
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M7 10l5 5 5-5H7z"/><path fill="none" d="M0 0h24v24H0z"/></svg>'); /* Custom dropdown arrow */
        background-repeat: no-repeat;
        background-position: calc(100% - 10px) center;
        cursor: pointer;
        transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
    }
    
    .form select:focus {
        outline: none;
        border-color: #9b5de5;
        box-shadow: 0 0 0 3px rgba(155, 93, 229, 0.2);
    }
    
    .form select option {
        padding: 10px;
    }
    
    /* Styling for when dropdown is opened */
    .form select:focus option:checked {
        background-color: #9b5de5;
        color: white;
    }
    
    /* Media query for smaller screens */
    @media (max-width: 576px) {
        .form select {
            font-size: 14px;
        }
    }
    
    
      
        section {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 80vh; /* Adjusted for better content visibility */
            padding-top: 50px; /* Adjusted for spacing */
            position: relative;
        }

        .card {
            background: rgba(255, 255, 255, 0.4);
            border-radius: 17px;
            border: 1px solid rgba(255, 255, 255, 0.4);
            position: relative;
            color: white;
            z-index: 1;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            padding: 20px;
            max-width: 400px; /* Adjusted for better responsiveness */
            width: 100%;
        }

        .card-pic {
            width: 100%;
            max-width: 200px;
            height: auto;
            border-radius: 10px;
            margin-bottom: 15px;
            object-fit: cover;
        }

        .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        button {
            padding: 10px 20px;
            font-size: 1rem;
            color: white;
            background-color: #666;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease-out;
        }

        button:hover {
            background-color: #333;
        }
        .dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 0 0 15px 15px;
            overflow: hidden;
            z-index: 1000;
            min-width: 150px;
        }

        .dropdown a {
            color: black;
            padding: 10px;
            display: block;
            text-align: left;
        }

        .dropdown a:hover {
            background-color: #f1f1f1;
        }

        .dropdown.show {
            display: block;
        }

        .profile-dropdown {
            position: absolute;
            right: 0;
            top: 100%;
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 0 0 15px 15px;
            overflow: hidden;
            z-index: 1000;
            min-width: 150px;
            display: none;
        }

        .profile-dropdown a {
            color: black;
            padding: 10px;
            display: block;
            text-align: left;
        }

        .profile-dropdown a:hover {
            background-color: #f1f1f1;
        }

        .profile-dropdown.show {
            display: block;
        }

        .rent-btn {
            background-color: #800080;
        }

        .rent-btn:hover {
            background-color: #4B0082;
        }

        .buy-btn {
            background-color: #007bff;
        }

        .buy-btn:hover {
            background-color: #0056b3;
        }

        h5 {
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
        }

        h6 {
            font-size: 1em;
            text-align: center;
        }

        .line {
            width: 100%;
            height: 3px;
            background-color: #5c99f5;
            opacity: 0.8;
            margin-bottom: 1px;
        }

        i {
            position: absolute;
            right: -2vw;
            bottom: -4vw;
            z-index: 2;
            color: white;
            font-size: 3rem;
            background: rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 1rem;
            border-radius: 10px;
            transition: all .6s ease-in-out;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        @keyframes SlowFloat {
            0% {
                transform: translateY(0);
            }
            100% {
                transform: translateY(-10px);
            }
        }

        .slowfloat2s {
            animation: SlowFloat 2s infinite alternate;
        }

        .slowfloat3s {
            animation: SlowFloat 3s infinite alternate;
        }

        @media (max-width: 768px) {
            .top {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="top">
        <a href="{% url 'home' %}"><img src="../static/Books_Image/Logo.png" class="logo" alt=""></a>
        <ul>
            <li class="icon-bar"><a href="{% url 'home' %}"><i class="fa-solid fa-house"></i><span class="sr-only">Home</span></a></li>
            <li class="icon-bar">
              <a href="javascript:void(0);" onclick="toggleDropdown('bookDropdown')"><i
                      class="fa-solid fa-book"></i></a>
              <div class="dropdown" id="bookDropdown">
                  <a href="{%url 'category' 'Non-Fiction'%}">Non-Fiction</a>
                  <a href="{%url 'category' 'Fiction'%}">Fiction</a>
              </div>
          </li>

            <li class="icon-bar"><a href="{% url 'cart_summary' %}"><i class="fas fa-shopping-cart"></i><span class="sr-only">Cart</span></a><span class="badge bg-dark text-white ms-1 rounded-pill" id="cart_quantity">{{ cart|length }}</span></li>
            <li class="icon-bar"><a href="{% url 'userpro' %}"><i class="fas fa-user"></i><span class="sr-only">{{request.user}}</span></a></li>
            <li class="icon-bar"><a href="{% url 'logout' %}"><i class="fas fa-user"></i><span class="sr-only">LOGOUT</span></a></li>
        </ul>
    </div>

    <section>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-8 col-md-6">
                    <div class="card py-3">
                        <div class="row">
                            <div class="col-10 col-md-4 col-lg-3 jelly-bloc text-center text-md-start">
                                <img src="{{ product.image.url }}" class="card-img-top card-pic slowfloat2s" alt="Product Image">
                            </div>
                            <div class="col-12 col-md-8 col-lg-9 card-body">
                                <h5 class="card-title">{{ product.name }}</h5>
                                <h6>Author: {{ product.author }}</h6>
                                <div class="line"></div>
                                <p class="card-text">
                                    {{ product.description }}<br>
                                    {{ product.price }}<br>
                                    ID: {{ product.id }}<br>
                                </p>
                                
                                <div class="button-container">
                                    <button type="button" value="{{ product.id }}" class="buy-btn" id="add-cart">Add To Cart</button>
                                </div>
                                <i class="fas fa-disease slowfloat3s"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

<script>
  function toggleDropdown(dropdownId) {
            var dropdown = document.getElementById(dropdownId);
            dropdown.classList.toggle('show');
        }

        window.onclick = function (event) {
            if (!event.target.matches('.fa-book') && !event.target.matches('.fa-user')) {
                var dropdowns = document.getElementsByClassName('dropdown');
                for (var i = 0; i < dropdowns.length; i++) {
                    var openDropdown = dropdowns[i];
                    if (openDropdown.classList.contains('show')) {
                        openDropdown.classList.remove('show');
                    }
                }
                var profileDropdowns = document.getElementsByClassName('profile-dropdown');
                for (var i = 0; i < profileDropdowns.length; i++) {
                    var openProfileDropdown = profileDropdowns[i];
                    if (openProfileDropdown.classList.contains('show')) {
                        openProfileDropdown.classList.remove('show');
                    }
                }
            }
        }

    jQuery(document).ready(function() {
        jQuery('#add-cart').on('click', function(e) {
            e.preventDefault();
            jQuery.ajax({
                type: 'POST',
                url: '{% url "cart_add" %}', // Ensure proper quoting for Django template tag
                data: {
                    product_id: jQuery(this).val(),
                    csrfmiddlewaretoken: '{{ csrf_token }}',
                    action: 'post'
                },
                success: function(json) {
                    if (json.status === 'success') {
                        document.getElementById("cart_quantity").textContent = json.qty;
                        alert(json.message);
                    } else {
                        alert('Failed to add product to cart: ' + json.message);
                    }
                },
                error: function(xhr, errmsg, err) {
                    console.log('Error:', errmsg);
                    alert('There was an error adding the product to the cart.');
                }
            });
        });
    });
</script>


</body>
</html>